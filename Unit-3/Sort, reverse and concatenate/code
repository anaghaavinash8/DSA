#include <stdio.h>
#include <stdlib.h>

typedef struct node {
    int data;
    struct node *next;
} NODE;

NODE* insertEnd(NODE *head, int val) {
    NODE *temp = (NODE*)malloc(sizeof(NODE));
    temp->data = val;
    temp->next = NULL;

    if (head == NULL) return temp;

    NODE *p = head;
    while (p->next != NULL)
        p = p->next;

    p->next = temp;
    return head;
}

void display(NODE *head) {
    NODE *p = head;
    while (p != NULL) {
        printf("%d -> ", p->data);
        p = p->next;
    }
    printf("NULL\n");
}


NODE* concatenate(NODE *first1, NODE *first2) {
    if (first1 == NULL && first2 == NULL) return NULL;
    if (first1 == NULL) return first2;
    if (first2 == NULL) return first1;

    NODE *last = first1;
    while (last->next != NULL)
        last = last->next;

    last->next = first2;
    return first1;
}

void sort(NODE *head) {
    if (head == NULL) return;

    for (NODE *i = head; i->next != NULL; i = i->next) {
        for (NODE *j = i->next; j != NULL; j = j->next) {
            if (i->data > j->data) {
                int temp = i->data;
                i->data = j->data;
                j->data = temp;
            }
        }
    }
}


NODE* reverse(NODE *head) {
    NODE *prev = NULL;
    NODE *current = head;
    NODE *next = NULL;

    while (current != NULL) {
        next = current->next;
        current->next = prev;
        prev = current;
        current = next;
    }
    return prev;
}


int main() {

    NODE *list1 = NULL;
    NODE *list2 = NULL;

    int choice, val;

    while (1) {
        printf("\n--- MENU ---\n");
        printf("1. Insert into List1\n");
        printf("2. Insert into List2\n");
        printf("3. Display List1\n");
        printf("4. Display List2\n");
        printf("5. Sort List1\n");
        printf("6. Reverse List1\n");
        printf("7. Concatenate List1 + List2\n");
        printf("8. Exit\n");

        printf("Enter choice: ");
        scanf("%d", &choice);

        switch (choice) {

        case 1:
            printf("Enter value to insert into List1: ");
            scanf("%d", &val);
            list1 = insertEnd(list1, val);
            break;

        case 2:
            printf("Enter value to insert into List2: ");
            scanf("%d", &val);
            list2 = insertEnd(list2, val);
            break;

        case 3:
            printf("\nList1: ");
            display(list1);
            break;

        case 4:
            printf("\nList2: ");
            display(list2);
            break;

        case 5:
            sort(list1);
            printf("List1 sorted.\n");
            break;

        case 6:
            list1 = reverse(list1);
            printf("List1 reversed.\n");
            break;

        case 7:
            list1 = concatenate(list1, list2);
            printf("Lists concatenated! New List1:\n");
            display(list1);
            break;

        case 8:
            exit(0);

        default:
            printf("Invalid choice!\n");
        }
    }

    return 0;
}
